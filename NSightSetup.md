# Setup for NSight Debugging

1. Generate an SSH key (If not done yet)

Generate an SSH key on your local machine and append it to the .ssh/authorized_keys on your dsmlp-login.ucsd.edu instance (the one you have been using).

This document shows you how to generate an ssh key on your local machine: https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent
After following the steps listed in the document, copy the contents in the ```.pub``` file generated in your local .ssh directory.

SSH into the dsmlp-login.ucsd.edu instance and paste (append) the contents in the .ssh/authorized_keys file.
Close the connection with dsmlp-login.ucsd.edu and try to ssh into it again. If all the steps were followed correctly, you would be able to connect without VSCode prompting for a password.


2. Add the following lines to your ssh config

(Replace USERNAME with your AD username)
```
Host vscode-dsmlp
  HostName dsmlp-login.ucsd.edu
  HostKeyAlias vscode-dsmlp
  IdentitiesOnly yes
  User USERNAME
  ProxyCommand ssh USERNAME@dsmlp-login.ucsd.edu launch-cse160-ssh.sh -g 1
```

https://user-images.githubusercontent.com/43923184/153686131-d5080b48-dedf-4379-9ce1-d7dc53489165.mov

3. SSH into vscode-dsmlp

https://user-images.githubusercontent.com/43923184/153686245-2dcb6006-36df-483f-93e6-60d1e6d0e208.mov

4. Install the required plugins - Nvidia Nsight extension and the C/C++ extension

https://user-images.githubusercontent.com/43923184/153686284-ce2b83de-ba14-437a-b5b7-9d244db723fd.mov

5. Open up the launch.json file and paste the following contents

(Replace the program with the path to the binary file generated by the make command and the argument field with any of the test cases)

```
{
    // Use IntelliSense to learn about possible attributes.
    // Hover to view descriptions of existing attributes.
    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
    "version": "0.2.0",
    "configurations": [
        {
            "name": "CUDA C++: Launch",
            "type": "cuda-gdb",
            "request": "launch",
            "gdb": "cuda-gdb",
            "program": "/home/rchandan/cse160-WI22/NSightDebugging/solution",
            "arguments": ["-e /home/rchandan/cse160-WI22/NSightDebugging/Dataset/0/output.raw -i /home/rchandan/cse160-WI22/NSightDebugging/Dataset/0/input1.raw,/home/rchandan/cse160-WI22/NSightDebugging/Dataset/0/input1.raw -t matrix"]
        }
    ]
}
```

https://user-images.githubusercontent.com/43923184/153686371-f7c2b5a7-277b-4265-b4e2-3d32112938d3.mov

6. Add breakpoints in your file from which you generated the binary and run with debugging

https://user-images.githubusercontent.com/43923184/153686736-4f7c25bf-738e-480a-982c-f71774720482.mov


Watch the Discussion section held on Feburuary 11th for more on using the NSight debugger!



